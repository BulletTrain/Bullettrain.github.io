<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="我的个人技术博客">
  <meta name="author" content="bullettrain1433">
  <meta name="keywords" content="">
  <title>shell复习6-gawk与sed - Just在路上</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/9.18.1/styles/github-gist.min.css" />


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_fmb4a04yx8h.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_ijqayz9ro8k.css">




<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


<meta name="generator" content="Hexo 4.2.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Just在路上</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">
              <i class="iconfont icon-home-fill"></i>
              首页</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">
              <i class="iconfont icon-archive-fill"></i>
              归档</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">
              <i class="iconfont icon-category-fill"></i>
              分类</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">
              <i class="iconfont icon-tags-fill"></i>
              标签</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">
              <i class="iconfont icon-user-fill"></i>
              关于</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <div class="mt-3 post-meta">
                  <i class="iconfont icon-date-fill" aria-hidden="true"></i>
                  <time datetime="2015-01-15 11:08">
                    星期四, 一月 15日 2015, 11:08 上午
                  </time>
                </div>
              

              <div class="mt-1">
                
                  
                  <span class="post-meta mr-2">
                    <i class="iconfont icon-chart"></i>
                    1.3k 字
                  </span>
                

                
                  
                  <span class="post-meta mr-2">
                      <i class="iconfont icon-clock-fill"></i>
                    
                    
                    17
                     分钟
                  </span>
                

                
              </div>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <p>##过滤器gawk(awk的GNU版本)<br>gawk是可以完成模式扫描和数据处理的语言。gawk搜索一个或者多个文件，查找其中匹配模式的记录,通常为行，通过执行指定的动作来处理这些记录。gawk可以使用变量、函数、算数运算符、关系运算符、关系数组、控制语句和c语言的printf语句，而高级gawk编程可以利用getline语句输入数据，使用协作进程让gawk与其他程序进行数据交换，或者通过网络连接与运行在远程系统上的数据交换数据。</p>
<p><strong><em>gawk常用选项说明</em></strong></p>
 <pre><code class="hljs plain">-F x  把x作为输入字段分隔符的值
-f 从后面的文件中而不是标准输入中读取gawk程序，可命令行多次指定这个选项
-W help 显示gawk的帮助信息
-W hint 对不正确或者不利于移植的结构发出警告</code></pre>

<p> <strong><em>例子</em></strong></p>
<p> 模式的使用</p>
<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> awk <span class="hljs-string">'$2 &gt;= 1988&#123;print NR&#125;'</span> example </span>
1
5
7
8

<span class="hljs-meta">$</span><span class="bash"> awk <span class="hljs-string">'/math/'</span> example   //数据行包含math的行</span>
lichang       1989   male     math       99
langxuebing   1978   male     math       86
lisi          1988   male     math       99
wangxuebing   1979   male     math       94

<span class="hljs-meta">$</span><span class="bash"> awk <span class="hljs-string">'$1~/l/'</span> example     //第一列包含l的数据行</span>
lichang       1989   male     math       99
wanglijiang   1987   femail   chinese    78
langxuebing   1978   male     math       86
liskai        1990   female   chinese    78
lisi          1988   male     math       99
wanglijiang   1989   female   chinese    78

<span class="hljs-meta">$</span><span class="bash"> awk <span class="hljs-string">'&#123;if($2~/1990/)$5=$5+5;print&#125;'</span> example  //第二列为1990的行第五列加上5</span>
lichang       1989   male     math       99
wanglijiang   1987   femail   chinese    78
zhangsansan   1977   male     computer   88
langxuebing   1978   male     math       86
liskai 1990 female chinese 83
zhangsan      1977   male     computer   83
lisi          1988   male     math       99
wanglijiang   1989   female   chinese    78
xuxing        1979   male     economic   81
xuxin         1985   female   english    90
wangxuebing   1979   male     math       94

<span class="hljs-meta">$</span><span class="bash"> awk <span class="hljs-string">'BEGIN&#123;print "-----------------学生基本信息----------------"&#125; &#123;print&#125;'</span> example  </span>
-----------------学生基本信息----------------
lichang       1989   male     math       99
wanglijiang   1987   femail   chinese    78
zhangsansan   1977   male     computer   88
langxuebing   1978   male     math       86
liskai        1990   female   chinese    78
zhangsan      1977   male     computer   83
lisi          1988   male     math       99
wanglijiang   1989   female   chinese    78
xuxing        1979   male     economic   81
xuxin         1985   female   english    90
wangxuebing   1979   male     math       94

<span class="hljs-meta">$</span><span class="bash"> awk <span class="hljs-string">'BEGIN&#123;print "统计学生总成绩";total=0&#125; &#123;print $5;total=total+$5&#125; END&#123;printf"学生平均成绩：%.2f\n",total/NR&#125;'</span> example </span>
统计学生总成绩
99
78
88
86
78
83
99
78
81
90
94
学生平均成绩：86.73

<span class="hljs-meta">$</span><span class="bash"> awk -F: <span class="hljs-string">'/zhangsan/,/zhangsansan/'</span> example //包含zhangsan和zhangsansan之间的文本行</span>
zhangsansan   1977   male     computer   88
zhangsan      1977   male     computer   83
lisi          1988   male     math       99
wanglijiang   1989   female   chinese    78
xuxing        1979   male     economic   81
xuxin         1985   female   english    90
wangxuebing   1979   male     math       94</code></pre>

<p><strong><em>指定动作</em></strong></p>
<p>如果awk匹配某个模式，它将执行awk命令的动作部分所指定的动作。如果没有指定动作，awk将执行默认动作，即print命令（可以用{print}显示显示），这个动作将记录从输入复制到标准输出。<br>如果在print命令后面带上参数，awk将只显示用户指定的参数。这些参数可以是变量或者字符串常量。可以将print命令的输出发送到文件（&gt;）、追加到文件（&gt;&gt;）或者通过管道将其发送到另外一个程序的输入（|）。协进程（|&amp;）是一个双向管道，可以与运行在后台的程序交换数据。<br>除非用逗号将print命令中的各输入项区分开，否则awk将他们连起来输出。逗号使得awk用输出字段分隔符将各项分隔开。</p>
<p><strong><em>使用重定向输出</em></strong></p>
<p>awk可通过（&gt;）可以重定向输出到文件</p>
<pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> vim redrectout</span>
/1989/ &#123;print &gt; "year1989"&#125;
/1978/ &#123;print &gt; "year1978"&#125;
END&#123;print "输出完毕!"&#125;
<span class="hljs-meta">$</span><span class="bash"> awk -f redirectout example</span>
输出完毕!
<span class="hljs-meta">$</span><span class="bash"> cat year1978</span>
langxuebing   1978   male     math       86
<span class="hljs-meta">$</span><span class="bash"> cat year1989</span>
lichang       1989   male     math       99
wanglijiang   1989   female   chinese    78</code></pre>

<p><strong><em>字符分隔符输出</em></strong><br>默认分隔符为空格，保存在变量OFS中，在用print语句进行输出打印时候，指定的多个字段之间用逗号分隔，而逗号表示就是OFS的值</p>
<pre><code class="hljs shell">//下面是输出包含Tom并且以:作为分隔符的行的第二行和第三行
<span class="hljs-meta">$</span><span class="bash"> awk -F[:] <span class="hljs-string">'/Tom/&#123;print $2,$3&#125;'</span> student </span>
10511163 93-09-11
10501166 88-01-11

//下面是输出字段的分隔符重置为Tab(转义字符为\t)
<span class="hljs-meta">$</span><span class="bash"> awk <span class="hljs-string">'BEGIN&#123;FS=":";OFS="\t"&#125;&#123;print $1,$2,$3&#125;'</span> student</span>
Tom Helleen	10511163	93-09-11
Tom Changle	10501166	88-01-11
Billy Black	10501165	93-02-18
John Hellen	10501162	93-04-13
Sam Possion	10501171	98-11-19
Mary Degens	10501169	95-05-22
Suli Vanlen	10501170	90-09-17</code></pre>
<p><strong><em>记录和字段介绍</em></strong></p>
<p>gawk把输入文件看做一个具有一定格式和结构的连续字符串来处理。默认每一个以换行符结束的行为一个记录<br>记录中每一个以空格或者Tab分隔符的字符串为一个字段，称为字段（也称为域）。每一行记录的字段数目是不一样的，变量NF中保存了当前记录的字段数目。变量FS保存了字段使用的分隔符，默认为空格符或者Tab。可以在BEGIN语句中或命令行使用-F选项来修改FS的设置，从而修改分隔符。</p>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/linux/">linux</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/shell/">shell</a>
                    
                      <a class="hover-with-bg" href="/tags/sed/">sed</a>
                    
                      <a class="hover-with-bg" href="/tags/gawk/">gawk</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2015/01/15/linux%E6%89%A9%E5%B1%95%E6%A0%B9%E5%88%86%E5%8C%BA/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">linux扩展根分区</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2015/01/14/shell%E5%A4%8D%E4%B9%A05-grep%E5%91%BD%E4%BB%A4/">
                        <span class="hidden-mobile">shell复习5-grep命令</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
              <!-- Comments -->
              <div class="comments" id="comments">
                
                
  <div id="vcomments"></div>
  <script defer src="https://cdn.staticfile.org/valine/1.4.4/Valine.min.js" ></script>

  <script type="text/javascript">
    var oldLoadVa = window.onload;
    window.onload = function () {
      oldLoadVa && oldLoadVa();

      new Valine({
        el: "#vcomments",
        app_id: "V11S2uoaiSwMEOxsYoj2k4oO-gzGzoHsz",
        app_key: "2quUPCFkFpUDMKBO9ODCKxLJ",
        placeholder: "说点什么",
        path: window.location.pathname,
        avatar: "retro",
        meta: ["nick","mail","link"],
        pageSize: "10",
        lang: "zh-CN",
        highlight: true,
        recordIP: false,
        serverURLs: "",
      });
    };
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://valine.js.org" target="_blank" rel="nofollow noopener noopener">comments
      powered by Valine.</a></noscript>


              </div>
            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    
  <div>
    
      <!-- 不蒜子统计PV -->
      
      <span id="busuanzi_container_site_pv" style="display: none">
      总访问量 <span id="busuanzi_value_site_pv"></span> 次
    </span>
    
    
      <!-- 不蒜子统计UV -->
      
      <span id="busuanzi_container_site_uv" style="display: none">
      总访客数 <span id="busuanzi_value_site_uv"></span> 人
    </span>
    
  </div>


    
  <!-- 备案信息 -->
  <div>
    <a href="http://beian.miit.gov.cn/" target="_blank" class="beian-icp"
       rel="nofollow noopener">皖ICP备19012602号-1</a>
    
      <a
        href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=12345678"
        rel="nofollow noopener"
        class="beian-police"
        target="_blank"
      >
        <span class="beian-police-sep">&nbsp;|&nbsp;</span>
        
          <img src="/img/police_beian.png" srcset="/img/loading.gif" alt="police-icon" />
        
        <span>皖ICP备19012602号</span>
      </a>
     
  </div>


    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/main.js" ></script>


  <script  src="/js/lazyload.js" ></script>



  
  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>





  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




<!-- Plugins -->


  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?38bdefbccaf592f43adb8787522107e2";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  

  

  

  

  



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "shell复习6-gawk与sed&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>







  
  
    <script type="text/javascript">
      //定义获取词语下标
      var a_idx = 0;
      jQuery(document).ready(function ($) {
        //点击body时触发事件
        $("body").click(function (e) {
          //需要显示的词语
          var a = new Array("富强", "民主", "文明", "和谐", "自由", "平等", "公正", "法治", "爱国", "敬业", "诚信", "友善");
          //设置词语给span标签
          var $i = $("<span/>").text(a[a_idx]);
          //下标等于原来下标+1  余 词语总数
          a_idx = (a_idx + 1) % a.length;
          //获取鼠标指针的位置，分别相对于文档的左和右边缘。
          //获取x和y的指针坐标
          var x = e.pageX, y = e.pageY;
          //在鼠标的指针的位置给$i定义的span标签添加css样式
          $i.css({
            "z-index": 999,
            "top": y - 20,
            "left": x,
            "position": "absolute",
            "font-weight": "bold",
            "color": rand_color()
          });
          // 随机颜色
          function rand_color() {
            return "rgb(" + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + ")"
          }
          //在body添加这个标签
          $("body").append($i);
          //animate() 方法执行 CSS 属性集的自定义动画。
          //该方法通过CSS样式将元素从一个状态改变为另一个状态。CSS属性值是逐渐改变的，这样就可以创建动画效果。
          //详情请看http://www.w3school.com.cn/jquery/effect_animate.asp
          $i.animate({
            //将原来的位置向上移动180
            "top": y - 180,
            "opacity": 0
            //1500动画的速度
          }, 1500, function () {
            //时间到了自动删除
            $i.remove();
          });
        });
      })
      ;
    </script>
  












</body>
</html>
